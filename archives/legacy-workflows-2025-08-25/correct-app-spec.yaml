name: trading-post-sso-fixed
region: nyc3

static_sites:
- name: trading-post-frontend
  github:
    repo: zrottmann/tradingpost
    branch: main
    deploy_on_push: true
  source_dir: /active-projects/trading-post/trading-app-frontend
  build_command: npm ci --legacy-peer-deps && npm run build
  output_dir: /build
  index_document: index.html
  catchall_document: index.html
  
  # Environment Variables with CORRECT values
  envs:
  - key: NODE_ENV
    value: production
  - key: REACT_APP_APPWRITE_ENDPOINT
    value: https://nyc.cloud.appwrite.io/v1
  - key: REACT_APP_APPWRITE_PROJECT_ID
    value: 689bdee000098bd9d55c
  - key: REACT_APP_APPWRITE_PROJECT_NAME
    value: Trading Post
  - key: REACT_APP_APPWRITE_DATABASE_ID
    value: trading_post_db
  - key: REACT_APP_APPWRITE_USERS_COLLECTION_ID
    value: users
  - key: REACT_APP_APPWRITE_ITEMS_COLLECTION_ID
    value: items
  - key: REACT_APP_APPWRITE_WANTS_COLLECTION_ID
    value: wants
  - key: REACT_APP_APPWRITE_TRADES_COLLECTION_ID
    value: trades
  - key: REACT_APP_APPWRITE_MESSAGES_COLLECTION_ID
    value: messages
  - key: REACT_APP_APPWRITE_REVIEWS_COLLECTION_ID
    value: reviews
  - key: REACT_APP_APPWRITE_NOTIFICATIONS_COLLECTION_ID
    value: notifications
  - key: REACT_APP_APPWRITE_ITEM_IMAGES_BUCKET_ID
    value: item_images
  - key: REACT_APP_APPWRITE_PROFILE_IMAGES_BUCKET_ID
    value: profile_images
  - key: REACT_APP_APPWRITE_CHAT_ATTACHMENTS_BUCKET_ID
    value: chat_attachments
  - key: REACT_APP_ENVIRONMENT
    value: production
  - key: REACT_APP_ENABLE_SSO
    value: "true"
  - key: REACT_APP_ENABLE_OAUTH
    value: "true"
  - key: REACT_APP_ENABLE_EMAIL_AUTH
    value: "true"
  - key: REACT_APP_OAUTH_PROVIDERS
    value: google,github,facebook
  - key: REACT_APP_ENABLE_MICROSOFT_AUTH
    value: "false"
  - key: REACT_APP_ENABLE_DISCORD_AUTH
    value: "false"
  - key: REACT_APP_ENABLE_APPLE_AUTH
    value: "false"
  - key: REACT_APP_ENABLE_ANALYTICS
    value: "false"
  - key: REACT_APP_OAUTH_CALLBACK_URL
    value: https://trading-post-sso-fixed-wxrpg.ondigitalocean.app/auth/callback
  - key: REACT_APP_OAUTH_ERROR_URL
    value: https://trading-post-sso-fixed-wxrpg.ondigitalocean.app/auth/error
  - key: REACT_APP_API_URL
    value: https://trading-post-sso-fixed-wxrpg.ondigitalocean.app